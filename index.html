<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer with Random Words</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        #container {
            text-align: center;
            max-width: 80%;
        }
        #display {
            font-size: 48px;
            margin-bottom: 20px;
            min-width: 150px;
        }
        #timer {
            display: block;
        }
        #word {
            display: block;
            margin: 10px 0;
        }
        #translation {
            display: block;
            margin: 10px 0;
        }
        #language-switch {
            font-size: 24px;
            margin-top: 20px;
        }
        #language-switch span {
            cursor: pointer;
            margin: 0 5px;
        }
        #language-switch span:hover {
            transform: scale(1.2);
        }
        .selected {
            font-weight: bold;
            border-bottom: 2px solid currentColor;
        }
        #meaning {
            margin-top: 20px;
            font-size: 18px;
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="display">
            <div id="timer">0</div>
            <div id="word"></div>
            <div id="translation"></div>
        </div>
        <div id="language-switch">
            <span role="img" aria-label="English" class="selected">ðŸ‡¬ðŸ‡§</span>
            <span role="img" aria-label="French">ðŸ‡«ðŸ‡·</span>
            <span role="img" aria-label="Italian">ðŸ‡®ðŸ‡¹</span>
            <span role="img" aria-label="Spanish">ðŸ‡ªðŸ‡¸</span>
            <span role="img" aria-label="German">ðŸ‡©ðŸ‡ª</span>
        </div>
        <div id="meaning"></div>
    </div>

    <script>
        let timer = 0;
        let words = [];
        let language = 'en-US';

        const languageUrls = {
            'en-US': 'https://random-word-api.herokuapp.com/word?number=5000&lang=en',
            'fr-FR': 'https://random-word-api.herokuapp.com/word?number=5000&lang=fr',
            'it-IT': 'https://random-word-api.herokuapp.com/word?number=5000&lang=it',
            'es-ES': 'https://random-word-api.herokuapp.com/word?number=5000&lang=es',
            'de-DE': 'https://random-word-api.herokuapp.com/word?number=5000&lang=de'
        };

        async function fetchWords() {
            try {
                let response = await fetch(languageUrls[language]);
                words = await response.json();
            } catch (error) {
                console.error('Error fetching words:', error);
            }
        }

        async function translateWord(word) {
            const response = await fetch(`https://api.mymemory.translated.net/get?q=${word}&langpair=${language}|en-US`);
            const data = await response.json();
            return data.responseData.translatedText;
        }

        async function fetchMeaning(word) {
            const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
            const data = await response.json();
            if (data && data.length > 0 && data[0].meanings && data[0].meanings.length > 0) {
                return data[0].meanings[0].definitions[0].definition;
            }
            return "No definition found.";
        }

        async function showRandomWord() {
            if (words.length > 0) {
                const randomWord = words[Math.floor(Math.random() * words.length)];
                let translatedWord = '';
                if (language !== 'en-US') {
                    translatedWord = await translateWord(randomWord);
                }
                const wordMeaning = await fetchMeaning(randomWord);
                const wordElement = document.getElementById('word');
                const translationElement = document.getElementById('translation');
                const meaningElement = document.getElementById('meaning');
                
                wordElement.textContent = randomWord;
                translationElement.textContent = translatedWord ? `(${translatedWord})` : '';
                meaningElement.textContent = `Meaning: ${wordMeaning}`;

                wordElement.style.display = 'block';
                translationElement.style.display = translatedWord ? 'block' : 'none';
            }
        }

        function updateTimer() {
            const timerElement = document.getElementById('timer');
            const wordElement = document.getElementById('word');
            const translationElement = document.getElementById('translation');

            if (timer >= 7) {
                timer = 0;
                showRandomWord();
            } else {
                timer++;
                timerElement.textContent = timer;
                wordElement.style.display = 'none';
                translationElement.style.display = 'none';
            }
        }

        async function switchLanguage(newLanguage) {
            language = newLanguage;
            await fetchWords();
            showRandomWord();
            document.querySelectorAll('#language-switch span').forEach(span => {
                span.classList.remove('selected');
            });
            document.querySelector(`[aria-label="${languageName(language)}"]`).classList.add('selected');
        }

        function languageName(lang) {
            switch (lang) {
                case 'en-US': return 'English';
                case 'fr-FR': return 'French';
                case 'it-IT': return 'Italian';
                case 'es-ES': return 'Spanish';
                case 'de-DE': return 'German';
            }
        }

        document.getElementById('language-switch').addEventListener('click', async (event) => {
            if (event.target.tagName === 'SPAN') {
                const selectedLanguage = event.target.getAttribute('aria-label');
                switch (selectedLanguage) {
                    case 'English':
                        await switchLanguage('en-US');
                        break;
                    case 'French':
                        await switchLanguage('fr-FR');
                        break;
                    case 'Italian':
                        await switchLanguage('it-IT');
                        break;
                    case 'Spanish':
                        await switchLanguage('es-ES');
                        break;
                    case 'German':
                        await switchLanguage('de-DE');
                        break;
                    default:
                        break;
                }
            }
        });

        function applyTheme() {
            const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)").matches;
            if (prefersDarkScheme) {
                document.documentElement.style.setProperty('--bg-color', '#333');
                document.documentElement.style.setProperty('--text-color', '#fff');
            } else {
                document.documentElement.style.setProperty('--bg-color', '#f0f0f0');
                document.documentElement.style.setProperty('--text-color', '#000');
            }
        }

        applyTheme();
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', applyTheme);

        fetchWords().then(() => {
            showRandomWord();
            setInterval(updateTimer, 1000);
        });
    </script>
</body>
</html>
